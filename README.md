# HashMap - C++ çº¢é»‘æ ‘å“ˆå¸Œè¡¨å®ç°

[![Language](https://img.shields.io/badge/Language-C++17-orange.svg)]()
[![Platform](https://img.shields.io/badge/Platform-Linux%20%7C%20macOS%20%7C%20Windows-lightgrey.svg)]()

ä¸€ä¸ªé«˜æ€§èƒ½çš„C++å“ˆå¸Œè¡¨å®ç°ï¼Œä½¿ç”¨çº¢é»‘æ ‘è§£å†³å“ˆå¸Œå†²çªï¼Œæ”¯æŒSTLæ ‡å‡†æ¥å£ã€‚

## âœ¨ æœ€æ–°æ›´æ–°

- âœ… **ä¿®å¤æ‰€æœ‰ç¼–è¯‘é”™è¯¯**: è§£å†³äº† `erase()` æ–¹æ³•ä¸­çš„ç¼–è¯‘é—®é¢˜
- âœ… **æ€§èƒ½ä¼˜åŒ–**: `find_in_bucket` æ–¹æ³•ç°åœ¨ä½¿ç”¨çº¢é»‘æ ‘çš„ `find()` æ–¹æ³•ï¼Œæå‡æŸ¥æ‰¾æ€§èƒ½
- âœ… **å®Œæ•´æµ‹è¯•è¦†ç›–**: 11ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼ŒåŒ…æ‹¬åŸºç¡€åŠŸèƒ½ã€STLå…¼å®¹æ€§å’Œå“ˆå¸Œç®—æ³•æµ‹è¯•
- âœ… **è·¨å¹³å°æ”¯æŒ**: åœ¨Windows MinGWç¯å¢ƒä¸‹å®Œå…¨å·¥ä½œ

## ğŸ“‹ é¡¹ç›®ç‰¹æ€§

- **çº¢é»‘æ ‘è§£å†³å†²çª**: ä½¿ç”¨è‡ªå¹³è¡¡çº¢é»‘æ ‘æ›¿ä»£ä¼ ç»Ÿé“¾è¡¨ï¼Œä¿è¯O(log n)æœ€åæƒ…å†µæŸ¥æ‰¾æ€§èƒ½
- **STLå…¼å®¹æ¥å£**: å®Œå…¨å…¼å®¹STL unordered_mapæ¥å£è§„èŒƒ
- **é«˜æ€§èƒ½å“ˆå¸Œ**: é›†æˆxxHash32ç®—æ³•ï¼Œæä¾›å¿«é€Ÿå‡åŒ€çš„å“ˆå¸Œåˆ†å¸ƒ
- **å†…å­˜å®‰å…¨**: é€šè¿‡AddressSanitizeréªŒè¯ï¼Œæ— å†…å­˜æ³„æ¼
- **å®Œæ•´æµ‹è¯•**: åŒ…å«åŠŸèƒ½æµ‹è¯•ã€æ€§èƒ½æµ‹è¯•å’Œè¾¹ç•Œæ¡ä»¶æµ‹è¯•

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¼–è¯‘è¦æ±‚

- C++17æˆ–æ›´é«˜ç‰ˆæœ¬ç¼–è¯‘å™¨
- CMake 3.10+
- æ”¯æŒå¹³å°ï¼šLinux, macOS, Windows

### ç¼–è¯‘é¡¹ç›®

```bash
# å…‹éš†é¡¹ç›®ï¼ˆåŒ…å«å­æ¨¡å—ï¼‰
git clone --recursive https://github.com/yourusername/HashMap.git
cd HashMap

# é…ç½®å’Œç¼–è¯‘ï¼ˆWindows MinGWï¼‰
cmake -B build -G "MinGW Makefiles"
cmake --build build

# æˆ–è€…åœ¨Unixç³»ç»Ÿä¸Š
cmake -B build
cmake --build build

# è¿è¡Œæµ‹è¯•
cd build
ctest --output-on-failure
```

### åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹

```cpp
#include "hashmap.hpp"
#include <iostream>

int main() {
    HashMap<std::string, int> map;
    
    // æ’å…¥é”®å€¼å¯¹
    map["apple"] = 5;
    map["banana"] = 3;
    map["orange"] = 8;
    
    // æŸ¥æ‰¾å…ƒç´ 
    auto it = map.find("apple");
    if (it != map.end()) {
        std::cout << "apple: " << it->second << std::endl;
    }
    
    // éå†æ‰€æœ‰å…ƒç´ 
    for (const auto& pair : map) {
        std::cout << pair.first << ": " << pair.second << std::endl;
    }
    
    return 0;
}
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
HashMap/
â”œâ”€â”€ hashmap.hpp              # ä¸»è¦çš„HashMapå®ç°
â”œâ”€â”€ utils/                   # å·¥å…·åº“
â”‚   â”œâ”€â”€ rbtree.hpp          # çº¢é»‘æ ‘å®ç°
â”‚   â”œâ”€â”€ xxhash32.hpp        # xxHash32å“ˆå¸Œç®—æ³•
â”‚   â”œâ”€â”€ mempool.hpp         # å†…å­˜æ± ç®¡ç†
â”‚   â”œâ”€â”€ vector.hpp          # å‘é‡å®¹å™¨
â”‚   â”œâ”€â”€ list.hpp            # é“¾è¡¨å®¹å™¨
â”‚   â””â”€â”€ bintree/            # äºŒå‰æ ‘åŸºç¡€ç±»
â”‚       â””â”€â”€ tree.hpp
â”œâ”€â”€ test/                   # æµ‹è¯•æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ basic/              # åŸºç¡€åŠŸèƒ½æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ simple_test.cpp
â”‚   â”‚   â””â”€â”€ test_constructors.cpp
â”‚   â”œâ”€â”€ functional/         # åŠŸèƒ½æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_comprehensive_final.cpp
â”‚   â”‚   â”œâ”€â”€ test_erase.cpp
â”‚   â”‚   â”œâ”€â”€ test_expansion.cpp
â”‚   â”‚   â”œâ”€â”€ test_hashmap.cpp
â”‚   â”‚   â”œâ”€â”€ test_iterator_issues.cpp
â”‚   â”‚   â””â”€â”€ test_memory_fix.cpp
â”‚   â”œâ”€â”€ stl_compliance/     # STLå…¼å®¹æ€§æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_basic_stl.cpp
â”‚   â”‚   â””â”€â”€ test_stl_compliance.cpp
â”‚   â””â”€â”€ hash/               # å“ˆå¸Œç®—æ³•æµ‹è¯•
â”‚       â””â”€â”€ test_xxhash.cpp
â”œâ”€â”€ bin/                    # ç¼–è¯‘ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶
â”œâ”€â”€ build/                  # CMakeæ„å»ºç›®å½•
â”œâ”€â”€ CMakeLists.txt          # CMakeæ„å»ºé…ç½®
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸ§ª æµ‹è¯•

é¡¹ç›®åŒ…å«å…¨é¢çš„æµ‹è¯•å¥—ä»¶ï¼ŒæŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡ï¼š

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cd build
ctest --output-on-failure

# è¿è¡Œç‰¹å®šæµ‹è¯•ï¼ˆä»é¡¹ç›®æ ¹ç›®å½•ï¼‰
./bin/simple_test             # åŸºç¡€åŠŸèƒ½æµ‹è¯•
./bin/test_constructors       # æ„é€ å‡½æ•°æµ‹è¯•
./bin/test_comprehensive_final # ç»¼åˆåŠŸèƒ½æµ‹è¯•
./bin/test_erase             # åˆ é™¤æ“ä½œæµ‹è¯•
./bin/test_expansion         # æ‰©å®¹æµ‹è¯•
./bin/test_hashmap           # å“ˆå¸Œè¡¨åŠŸèƒ½æµ‹è¯•
./bin/test_iterator_issues   # è¿­ä»£å™¨æµ‹è¯•
./bin/test_memory_fix        # å†…å­˜ç®¡ç†æµ‹è¯•
./bin/test_xxhash            # å“ˆå¸Œç®—æ³•æµ‹è¯•
./bin/test_basic_stl         # STLåŸºç¡€å…¼å®¹æ€§æµ‹è¯•
./bin/test_stl_compliance    # STLå®Œæ•´å…¼å®¹æ€§æµ‹è¯•

# é‡æ–°æ„å»ºå’Œæµ‹è¯•
cmake --build build && cd build && ctest
```

### æµ‹è¯•ç±»åˆ«è¯´æ˜

- **basic/**: åŸºç¡€åŠŸèƒ½æµ‹è¯•ï¼ŒåŒ…æ‹¬ç®€å•æ“ä½œå’Œæ„é€ å‡½æ•°
- **functional/**: åŠŸèƒ½æµ‹è¯•ï¼ŒåŒ…æ‹¬åˆ é™¤ã€æ‰©å®¹ã€å†…å­˜ç®¡ç†ç­‰
- **stl_compliance/**: STLæ ‡å‡†æ¥å£å…¼å®¹æ€§æµ‹è¯•
- **hash/**: å“ˆå¸Œç®—æ³•æ€§èƒ½å’Œæ­£ç¡®æ€§æµ‹è¯•

## ğŸ“Š æ€§èƒ½ç‰¹ç‚¹

| æ“ä½œ | å¹³å‡æ—¶é—´å¤æ‚åº¦ | æœ€åæ—¶é—´å¤æ‚åº¦ |
|------|---------------|---------------|
| æ’å…¥ | O(1) | O(log n) |
| æŸ¥æ‰¾ | O(1) | O(log n) |
| åˆ é™¤ | O(1) | O(log n) |
| éå† | O(n) | O(n) |

## ğŸ”§ æ ¸å¿ƒå®ç°ç‰¹ç‚¹

### ä¼˜åŒ–çš„æŸ¥æ‰¾æ€§èƒ½
- **çº¢é»‘æ ‘ä¼˜åŒ–**: `find_in_bucket` æ–¹æ³•ä½¿ç”¨çº¢é»‘æ ‘çš„ `find()` æ–¹æ³•è€Œéçº¿æ€§éå†
- **æ—¶é—´å¤æ‚åº¦**: æ¡¶å†…æŸ¥æ‰¾ä» O(n) ä¼˜åŒ–ä¸º O(log n)
- **å“ˆå¸Œå†²çªå¤„ç†**: ä½¿ç”¨è‡ªå¹³è¡¡çº¢é»‘æ ‘å­˜å‚¨å†²çªçš„é”®å€¼å¯¹

### åŠ¨æ€æ‰©å®¹æœºåˆ¶
å½“è´Ÿè½½å› å­è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œè‡ªåŠ¨æ‰©å®¹å¹¶é‡æ–°å“ˆå¸Œæ‰€æœ‰å…ƒç´ ï¼Œä¿æŒé«˜æ€§èƒ½ã€‚

### xxHash32å“ˆå¸Œç®—æ³•
ä½¿ç”¨xxHash32ç®—æ³•æä¾›å¿«é€Ÿã€å‡åŒ€çš„å“ˆå¸Œåˆ†å¸ƒï¼Œå‡å°‘å†²çªæ¦‚ç‡ã€‚

### å†…å­˜å®‰å…¨
- é€šè¿‡å…¨é¢çš„æµ‹è¯•éªŒè¯å†…å­˜å®‰å…¨æ€§
- æ”¯æŒå¼‚å¸¸å®‰å…¨çš„æ“ä½œ
- æ­£ç¡®çš„èµ„æºç®¡ç†å’Œæ¸…ç†

## ğŸ“ APIæ–‡æ¡£

### ä¸»è¦æ¥å£

- `insert(key, value)` - æ’å…¥é”®å€¼å¯¹
- `find(key)` - æŸ¥æ‰¾æŒ‡å®šé”®ï¼ˆä¼˜åŒ–çš„O(log n)æ¡¶å†…æŸ¥æ‰¾ï¼‰
- `erase(key)` - åˆ é™¤æŒ‡å®šé”®
- `operator[](key)` - è®¿é—®æˆ–æ’å…¥å…ƒç´ 
- `size()` - è·å–å…ƒç´ æ•°é‡
- `empty()` - æ£€æŸ¥æ˜¯å¦ä¸ºç©º
- `clear()` - æ¸…ç©ºæ‰€æœ‰å…ƒç´ 

### è¿­ä»£å™¨æ”¯æŒ

- `begin()` / `end()` - æ­£å‘è¿­ä»£å™¨
- `cbegin()` / `cend()` - å¸¸é‡è¿­ä»£å™¨
- æ”¯æŒèŒƒå›´forå¾ªç¯
- å®Œå…¨ç¬¦åˆSTLè¿­ä»£å™¨è§„èŒƒ

### æ„é€ å‡½æ•°

- é»˜è®¤æ„é€ å‡½æ•°
- æ‹·è´æ„é€ å‡½æ•°
- ç§»åŠ¨æ„é€ å‡½æ•°
- åˆå§‹åŒ–åˆ—è¡¨æ„é€ å‡½æ•°
- èµ‹å€¼æ“ä½œç¬¦ï¼ˆæ‹·è´å’Œç§»åŠ¨ï¼‰

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Forkæœ¬é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»ºPull Request

## ğŸ™ è‡´è°¢

- [xxHash](https://github.com/Cyan4973/xxHash) - å¿«é€Ÿå“ˆå¸Œç®—æ³•
- æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…å’Œæµ‹è¯•äººå‘˜

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- åˆ›å»ºGitHub Issue

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€é¢—æ˜Ÿï¼
